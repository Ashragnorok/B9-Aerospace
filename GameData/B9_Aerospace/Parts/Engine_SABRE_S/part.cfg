PART
{
    // --- general parameters ---
    name = B9_Engine_SABRE_S
    module = Part
    author = bac9-flcl (textures), Taverius (model)

    // --- asset parameters ---
    mesh = model.mu
    scale = 1.0
    rescaleFactor = 1

    // --- node definitions ---
    node_stack_top = 0.0, 1.25, 0.0, 0.0, -1.0, 0.0, 1
    node_attach = 0.0, 0.625, 0.625, 0.0, 0.0, -1.0
    CoMOffset = 0.0, -0.625, 0.0

    // --- editor parameters ---
    TechRequired = hypersonicFlight
    entryCost = 69000
    cost = 6500
    category = Propulsion
    subcategory = 0
    title = SABRE S Engine
    manufacturer = Tetragon Projects
    description = Combined-cycle rocket engine. Mode #1 is a turbocompressed air-breathing rocket/ramjet engine. Mode #2 is a high efficiency rocket engine. More convenient and easier to pull off than relying on using multiple engine types, but marginally less efficient than some specialized combinations.

    // attachment rules: stack, srfAttach, allowStack, allowSrfAttach, allowCollision
    attachRules = 1,1,1,1,0

    // --- standard part parameters ---
    mass = 1.5
    dragModelType = default
    maximum_drag = 0.2
    minimum_drag = 0.2
    angularDrag = 2
    crashTolerance = 7
    breakingForce = 750
    breakingTorque = 750
    maxTemp = 3600

    EFFECTS
    {
        running_closed
        {
            AUDIO
            {
                channel = Ship
                clip = sound_rocket_spurts
                volume = 0.0 0.0
                volume = 1.0 1.0
                pitch = 0.0 0.2
                pitch = 1.0 1.0
                loop = true
            }
            MODEL_MULTI_PARTICLE_PERSIST
            {
                name = b9_sabre_s_flame_closed
                modelName = B9_Aerospace/FX/HR/KWflamesmall
                transformName = thrust_transform
                emission = 0.0 0.0
                emission = 0.25 0.99
                emission = 0.75 1.21
                emission = 1.0 1.25
                speed = 0.0 1.98
                speed = 1.0 1.72
                energy = 0.0 0.33
                energy = 1.0 0.99
                localPosition = 0, 0, 1
                fixedScale = 0.75
            }
            MODEL_MULTI_PARTICLE_PERSIST
            {
                name = b9_sabre_s_smoke_closed
                modelName = B9_Aerospace/FX/HR/smokebooster2
                transformName = thrust_transform
                emission = 0.0 0.0
                emission = 0.07 0.0
                emission = 0.2 0.4
                emission = 1.0 1.1
                energy = 0.0 0.2
                energy = 1.0 3.2
                speed = 0.0 1.0
                speed = 1.0 0.8
                grow = 0.0 0.0
                grow = 1.0 0.11

                offset = 0.0 0.0
                offset = 1.0 0.5

                size = 0.0 1.0
                size = 1.0 1.1

                emission
                {
                    density = 1.0 1.0
                    density = 0.002 1.0
                    density = 0.001 0.0
                }
            }
        }
        power_open
        {
            AUDIO
            {
                channel = Ship
                clip = sound_rocket_spurts
                volume = 0.0 0.0
                volume = 1.0 1.0
                pitch = 0.0 0.2
                pitch = 1.0 1.0
                loop = true
            }
            AUDIO
            {
                channel = Ship
                clip = sound_jet_deep
                volume = 0.0 0.0
                volume = 1.0 0.5
                pitch = 0.0 0.2
                pitch = 1.0 1.0
                loop = true
            }
            MODEL_MULTI_PARTICLE_PERSIST
            {
                name = b9_sabre_s_flame_open
                modelName = B9_Aerospace/FX/HR/flamejet
                transformName = thrust_transform
                emission = 0.0 0.0
                emission = 0.25 0.99
                emission = 0.75 1.21
                emission = 1.0 1.43
                speed = 0.0 1.98
                speed = 1.0 1.72
                energy = 0.0 0.33
                energy = 1.0 0.99
                localPosition = 0, 0, 0.8
                fixedScale = 0.8
            }
            //MODEL_MULTI_PARTICLE_PERSIST
            //{
                //name = b9_sabre_s_ram_horizontal
                //modelName = B9_Aerospace/FX/fx_sabre_s_ramjet_horizontal
                //transformName = ramjet_emitter
                //emission = 0.0 0.0
                //emission = 0.1 0.0
                //emission = 0.105 1.0
                //emission = 1.0 2.0
                //energy = 0.0 0.8
                //energy = 1.0 1.35
                //speed = 0.0 1
                //speed = 1.0 2.4
                //renderMode = HorizontalBillboard
                //angle = 0.0 1.0
                //angle = 40.0 1.0
                //angle = 50.0 0.0
                //angle = 90.0 0.0
            //}
            //MODEL_MULTI_PARTICLE_PERSIST
            //{
                //name = b9_sabre_s_ram_vertical
                //modelName = B9_Aerospace/FX/fx_sabre_m_ramjet_vertical
                //transformName = ramjet_emitter_vertical
                //emission = 0.0 0.0
                //emission = 0.05 0.0
                //emission = 0.075 0.25
                //emission = 1.0 1.25
                //speed = 0.0 0.0
                //speed = 1.0 0.0
                //renderMode = VerticalBillboard
                //angle = 0.0 0.0
                //angle = 40.0 0.0
                //angle = 50.0 1.0
                //angle = 90.0 1.0
            //}
        }
        running_open
        {
            AUDIO
            {
                channel = Ship
                clip = sound_jet_low
                volume = 0.0 0.0
                volume = 1.0 1.0
                pitch = 0.0 0.2
                pitch = 1.0 1.0
                loop = true
            }
            MODEL_MULTI_PARTICLE_PERSIST
            {
                name = b9_sabre_s_smoke_open
                modelName = B9_Aerospace/FX/HR/smokejet
                transformName = thrust_transform
                emission = 0.0 0.0
                emission = 0.07 0.0
                emission = 0.2 0.4
                emission = 1.0 1.1
                energy = 0.0 0.2
                energy = 1.0 3.2
                speed = 0.0 1.0
                speed = 1.0 0.8
                grow = 0.0 0.0
                grow = 1.0 0.11

                offset = 0.0 0.0
                offset = 1.0 0.5

                size = 0.0 1.0
                size = 1.0 1.1

                emission
                {
                    density = 1.0 1.0
                    density = 0.002 1.0
                    density = 0.001 0.0
                }
            }
            //MODEL_MULTI_PARTICLE_PERSIST
            //{
                //name = b9_sabre_s_ram_heat
                //modelName = B9_Aerospace/FX/fx_sabre_s_ramjet_heat
                //transformName = ramjet_emitter_heat
                //renderMode = HorizontalBillboard
                //emission = 1.0 2
                //energy = 1.0 0.35
                //speed = 1.0 0.0
                //angle = 0.0 1.0
                //angle = 80.0 1.0
                //angle = 90.0 0.0
                //emission
                //{
                    //partheat = 0.0 0.0
                    //partheat = 0.05 0.0
                    //partheat = 0.66 0.5
                    //partheat = 1.0 1.0
                //}
            //}
        }
        engage
        {
            AUDIO
            {
                channel = Ship
                clip = sound_vent_medium
                volume = 1.0
                pitch = 2.0
                loop = false
            }
        }
        disengage
        {
            AUDIO
            {
                channel = Ship
                clip = sound_vent_soft
                volume = 1.0
                pitch = 2.0
                loop = false
            }
        }
        flameout_open
        {
            PREFAB_PARTICLE
            {
                prefabName = fx_exhaustSparks_flameout_2
                transformName = thrust_transform
                oneShot = true
                localOffset = 0, 0, 1.7
            }
            AUDIO
            {
                channel = Ship
                clip = sound_explosion_low
                volume = 1.0
                pitch = 2.0
                loop = false
            }
        }
        flameout_closed
        {
            AUDIO
            {
                channel = Ship
                clip = sound_explosion_low
                volume = 1.0
                pitch = 2.0
                loop = false
            }
        }
    }

    MODULE
    {
        name = MultiModeEngine
        primaryEngineID = AirBreathing
        secondaryEngineID = ClosedCycle
    }

    // Air-Breathing Mode
    MODULE
    {
        name = ModuleEnginesFX
        engineID = AirBreathing
        powerEffectName = power_open
        runningEffectName = running_open
        flameoutEffectName = flameout_open
        thrustVectorTransformName = thrust_transform
        exhaustDamage = True
        ignitionThreshold = 0.1
        minThrust = 0
        maxThrust = 215
        heatProduction = 450
        useEngineResponseTime = True
        engineAccelerationSpeed = 0.4
        engineDecelerationSpeed = 0.7
        useVelocityCurve = True
        PROPELLANT
        {
            name = LiquidFuel
            ratio = 1
            DrawGauge = True
        }
        PROPELLANT
        {
            name = IntakeAir
            ratio = 9
        }
        atmosphereCurve
        {
            //    Atm.P.  Isp   iTan oTan
            key = 0       2351  0    3.26E+07
            key = 7.5E-06 2564  0    0
            key = 0.0006  2159  0    0
            key = 0.11    2413  0    0
            key = 1       2084 -660  0
        }
        velocityCurve
        {
            //    m/s  %F    iTan   oTan
            key = 0    0.85  0     -0.0007
            key = 300  0.75  0      0
            key = 1500 1     0      0
            key = 1650 0.88 -0.003 -0.003
            key = 1800 0     0      0
        }
    }

    // Rocket Mode
    MODULE
    {
        name = ModuleEnginesFX
        engineID = ClosedCycle
        runningEffectName = running_closed
        flameoutEffectName = flameout_closed
        thrustVectorTransformName = thrust_transform
        exhaustDamage = True
        ignitionThreshold = 0.1
        minThrust = 0
        maxThrust = 185
        heatProduction = 550
        PROPELLANT
        {
            name = LiquidFuel
            ratio = 0.9
            DrawGauge = True
        }
        PROPELLANT
        {
            name = Oxidizer
            ratio = 1.1
        }
        atmosphereCurve
        {
            key = 0 385
            key = 1 370
        }
    }

    MODULE
    {
        name = ModuleAnimateHeat
        ThermalAnim = sabre_125_heat_nozzle
    }

    // Alternator & Power
    MODULE
    {
        name = ModuleAlternator
        RESOURCE
        {
            name = ElectricCharge
            rate = 5.0
        }
    }

    MODULE
    {
        name = KM_Gimbal
        gimbalTransformName = thrust_transform
        pitchGimbalRange = 3
        yawGimbalRange = 3
        enableRoll = true
        enableSmoothGimbal = true
        responseSpeed = 80
    }

    RESOURCE
    {
        name = ElectricCharge
        amount = 0
        maxAmount = 0
        isTweakable = false
        hideFlow = true
    }
}
